"use strict";(self.webpackChunkosmosis_docs=self.webpackChunkosmosis_docs||[]).push([[597],{50597:(e,t,i)=>{i.r(t),i.d(t,{dyte_participants_audio:()=>s});var o=i(94196),a=i(29799),n=i(61070);i(41969),i(55752);class r{constructor(){this.audio=document.createElement("audio"),this.audio.autoplay=!0,this.audioStream=new MediaStream,this.audio.srcObject=this.audioStream,this.audioTracks=[]}addTrack(e,t){this.audioTracks.some((t=>t.id===e))||(this.audioTracks.push({id:e,track:t}),this.audioStream.addTrack(t),this.play())}removeTrack(e){const t=this.audioTracks.find((t=>t.id===e));null!=t&&(this.audioStream.removeTrack(t.track),this.audioTracks=this.audioTracks.filter((t=>t.id!==e)))}async play(){var e;this.audio.srcObject=this.audioStream,await(null===(e=this.audio.play())||void 0===e?void 0:e.catch((e=>{"NotAllowedError"===e.name?null!=this._onError&&this._onError():"AbortError"!==e.name&&a.l.error("[dyte-audio] play() error\n",e)})))}async setDevice(e){var t,i,o;await(null===(o=null===(i=(t=this.audio).setSinkId)||void 0===i?void 0:i.call(t,e))||void 0===o?void 0:o.catch((e=>{a.l.error("[dyte-audio] setSinkId() error\n",e)})))}onError(e){this._onError=e}}const s=class{constructor(e){(0,o.r)(this,e),this.t=(0,n.u)(),this.showPlayDialog=!1}componentDidLoad(){this.meetingChanged(this.meeting)}disconnectedCallback(){null!=this.meeting&&(this.audioUpdateListener&&this.meeting.participants.active.removeListener("audioUpdate",this.audioUpdateListener),this.screenShareUpdateListener&&this.meeting.participants.joined.removeListener("screenShareUpdate",this.screenShareUpdateListener),this.participantLeftListener&&this.meeting.participants.joined.removeListener("participantLeft",this.participantLeftListener),this.deviceUpdateListener&&this.meeting.self.removeListener("deviceUpdate",this.deviceUpdateListener))}async meetingChanged(e){if(null!=e){this.audio=new r,this.audio.onError((()=>{this.showPlayDialog=!0})),this.audio.play();const t=e.self.getCurrentDevices();null!=t.speaker&&await this.audio.setDevice(t.speaker.deviceId),this.audioUpdateListener=({id:e,audioEnabled:t,audioTrack:i})=>{const o=`audio-${e}`;t&&null!=i?this.audio.addTrack(o,i):this.audio.removeTrack(o)};{const t=e.participants.joined.toArray();for(const e of t)this.audioUpdateListener(e)}this.participantLeftListener=({id:e})=>{this.audio.removeTrack(`audio-${e}`),this.audio.removeTrack(`screenshare-${e}`)},this.screenShareUpdateListener=({id:e,screenShareEnabled:t,screenShareTracks:i})=>{const o=`screenshare-${e}`;t&&null!=i.audio?this.audio.addTrack(o,i.audio):this.audio.removeTrack(o)},this.deviceUpdateListener=({device:e,preview:t})=>{t||"audiooutput"===e.kind&&this.audio.setDevice(e.deviceId)},e.participants.joined.addListener("audioUpdate",this.audioUpdateListener),e.participants.joined.addListener("screenShareUpdate",this.screenShareUpdateListener),e.participants.joined.addListener("participantLeft",this.participantLeftListener),e.self.addListener("deviceUpdate",this.deviceUpdateListener)}}render(){return(0,o.h)(o.H,null,this.showPlayDialog&&(0,o.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.showPlayDialog=!1}},(0,o.h)("div",{class:"modal"},(0,o.h)("h3",null,this.t("Allow Audio Playback")),(0,o.h)("p",null,this.t("In order to play audio properly on your device, click the button below")),(0,o.h)("dyte-button",{kind:"wide",onClick:()=>{this.audio.play(),this.showPlayDialog=!1},title:this.t("Play Audio")},this.t("Play Audio")))))}static get watchers(){return{meeting:["meetingChanged"]}}};s.style=":host{display:block;font-family:var(--dyte-font-family, sans-serif);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.modal{box-sizing:border-box;width:100%;max-width:var(--dyte-space-96, 384px);padding:var(--dyte-space-4, 16px);border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.modal h3{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px);font-size:24px;font-weight:500}.modal p{margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-6, 24px)}.modal dyte-button{width:100%}"},61070:(e,t,i)=>{i.d(t,{g:()=>a,u:()=>n});var o=i(55752);const a=async e=>{if(null==e||"en"===e||""===e.trim())return o.d;try{const t=await fetch(`http://localhost:5000/${e}.json`);return t.ok?Object.assign({},o.d,await t.json()):o.d}catch(t){return o.d}},n=(e=o.d)=>t=>{var i;return null!==(i=e[t])&&void 0!==i?i:t}},29799:(e,t,i)=>{i.d(t,{l:()=>a});var o=i(41969),a=(0,o.c)((function(e){var t,i;t=o.a,i=function(){var e=function(){},t="undefined",i=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"];function a(e,t){var i=e[t];if("function"==typeof i.bind)return i.bind(e);try{return Function.prototype.bind.call(i,e)}catch(o){return function(){return Function.prototype.apply.apply(i,[e,arguments])}}}function n(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function r(o){return"debug"===o&&(o="log"),typeof console!==t&&("trace"===o&&i?n:void 0!==console[o]?a(console,o):void 0!==console.log?a(console,"log"):e)}function s(t,i){for(var a=0;a<o.length;a++){var n=o[a];this[n]=a<t?e:this.methodFactory(n,t,i)}this.log=this.debug}function d(e,i,o){return function(){typeof console!==t&&(s.call(this,i,o),this[e].apply(this,arguments))}}function c(e,t,i){return r(e)||d.apply(this,arguments)}function l(e,i,a){var n,r=this;i=null==i?"WARN":i;var d="loglevel";function l(){var e;if(typeof window!==t&&d){try{e=window.localStorage[d]}catch(a){}if(typeof e===t)try{var i=window.document.cookie,o=i.indexOf(encodeURIComponent(d)+"=");-1!==o&&(e=/^([^;]+)/.exec(i.slice(o))[1])}catch(a){}return void 0===r.levels[e]&&(e=void 0),e}}"string"==typeof e?d+=":"+e:"symbol"==typeof e&&(d=void 0),r.name=e,r.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},r.methodFactory=a||c,r.getLevel=function(){return n},r.setLevel=function(i,a){if("string"==typeof i&&void 0!==r.levels[i.toUpperCase()]&&(i=r.levels[i.toUpperCase()]),!("number"==typeof i&&i>=0&&i<=r.levels.SILENT))throw"log.setLevel() called with invalid level: "+i;if(n=i,!1!==a&&function(e){var i=(o[e]||"silent").toUpperCase();if(typeof window!==t&&d){try{return void(window.localStorage[d]=i)}catch(a){}try{window.document.cookie=encodeURIComponent(d)+"="+i+";"}catch(a){}}}(i),s.call(r,i,e),typeof console===t&&i<r.levels.SILENT)return"No console available for logging"},r.setDefaultLevel=function(e){i=e,l()||r.setLevel(e,!1)},r.resetLevel=function(){r.setLevel(i,!1),function(){if(typeof window!==t&&d){try{return void window.localStorage.removeItem(d)}catch(e){}try{window.document.cookie=encodeURIComponent(d)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},r.enableAll=function(e){r.setLevel(r.levels.TRACE,e)},r.disableAll=function(e){r.setLevel(r.levels.SILENT,e)};var u=l();null==u&&(u=i),r.setLevel(u,!1)}var u=new l,p={};u.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=p[e];return t||(t=p[e]=new l(e,u.getLevel(),u.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return u.noConflict=function(){return typeof window!==t&&window.log===u&&(window.log=h),u},u.getLoggers=function(){return p},u.default=u,u},e.exports?e.exports=i():t.log=i()}));a.enableAll()}}]);