"use strict";(self.webpackChunkosmosis_docs=self.webpackChunkosmosis_docs||[]).push([[9711],{3905:(e,t,o)=>{o.d(t,{Zo:()=>p,kt:()=>d});var n=o(67294);function s(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function i(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function r(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?i(Object(o),!0).forEach((function(t){s(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function a(e,t){if(null==e)return{};var o,n,s=function(e,t){if(null==e)return{};var o,n,s={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||(s[o]=e[o]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}var l=n.createContext({}),h=function(e){var t=n.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):r(r({},t),e)),o},p=function(e){var t=h(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var o=e.components,s=e.mdxType,i=e.originalType,l=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),u=h(o),d=s,m=u["".concat(l,".").concat(d)]||u[d]||c[d]||i;return o?n.createElement(m,r(r({ref:t},p),{},{components:o})):n.createElement(m,r({ref:t},p))}));function d(e,t){var o=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var i=o.length,r=new Array(i);r[0]=u;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a.mdxType="string"==typeof e?e:s,r[1]=a;for(var h=2;h<i;h++)r[h]=o[h];return n.createElement.apply(null,r)}return n.createElement.apply(null,o)}u.displayName="MDXCreateElement"},65349:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>i,metadata:()=>a,toc:()=>h});var n=o(87462),s=(o(67294),o(3905));const i={sidebar_position:2},r="Airdrop Distribution",a={unversionedId:"integrate/airdrops",id:"integrate/airdrops",title:"Airdrop Distribution",description:"Overview",source:"@site/docs/overview/integrate/airdrops.md",sourceDirName:"integrate",slug:"/integrate/airdrops",permalink:"/overview/integrate/airdrops",draft:!1,editUrl:"https://github.com/osmosis-labs/docs/tree/main/docs/overview/integrate/airdrops.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Introduction",permalink:"/overview/integrate/"},next:{title:"Concentrated Liquidity Integration",permalink:"/overview/integrate/on-chain"}},l={},h=[{value:"Overview",id:"overview",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Choosing a block height",id:"choosing-a-block-height",level:3},{value:"Choosing pool IDs",id:"choosing-pool-ids",level:3},{value:"Determine Osmosis node type requirement",id:"determine-osmosis-node-type-requirement",level:3},{value:"Run an Osmosis node",id:"run-an-osmosis-node",level:3},{value:"Install the daemon version corresponding to snapshot height",id:"install-the-daemon-version-corresponding-to-snapshot-height",level:3},{value:"Take the state export (snapshot)",id:"take-the-state-export-snapshot",level:3},{value:"Export accounts in JSON format",id:"export-accounts-in-json-format",level:3}],p={toc:h};function c(e){let{components:t,...i}=e;return(0,s.kt)("wrapper",(0,n.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"airdrop-distribution"},"Airdrop Distribution"),(0,s.kt)("h2",{id:"overview"},"Overview"),(0,s.kt)("p",null,"As more chains enter the cosmos ecosystem, more projects may desire to airdrop their tokens to Osmosis accounts."),(0,s.kt)("p",null,"This document lays out the process of creating a state export to derive all Osmosis account addresses that existed at a specified height. We will then show how to further filter this list to also airdrop to accounts providing liquidity to specific Osmosis pools."),(0,s.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Know what block height you want to take the snapshot at"),(0,s.kt)("li",{parentName:"ol"},"Know the pool IDs if looking to airdrop to accounts LPing to specific pools"),(0,s.kt)("li",{parentName:"ol"},"Run an Osmosis node with enough state history to state export at the desired height")),(0,s.kt)("h3",{id:"choosing-a-block-height"},"Choosing a block height"),(0,s.kt)("p",null,"The current Osmosis block height can be found on the ",(0,s.kt)("a",{parentName:"p",href:"https://www.mintscan.io/osmosis/blocks"},"Mintscan blocks page"),". To find the date/time of a specific block height in the past, type the desired block height in the Mintscan search bar and press enter. Here is the Mintscan block height page for block 2138101:"),(0,s.kt)("p",null,(0,s.kt)("img",{src:o(2049).Z,width:"1724",height:"964"})),(0,s.kt)("p",null,"In this example, block height 2138101 happened on 25 November 2021 at 12:59:55AM local time."),(0,s.kt)("p",null,"Change this value until you have a block height at the time you want to perform the snapshot."),(0,s.kt)("h3",{id:"choosing-pool-ids"},"Choosing pool IDs"),(0,s.kt)("p",null,"If your organization also wants to airdrop tokens to liquidity providers of specific Osmosis pools, you must first determine the pool IDs of the pools in question. The easiest way to find the pool ID is to go to the ",(0,s.kt)("a",{parentName:"p",href:"https://info.osmosis.zone/pools"},"info.osmosis.zone pools page")," and note the number in the furthest left column for all the desired pools. You will need these pool IDs later."),(0,s.kt)("p",null,(0,s.kt)("img",{src:o(95429).Z,width:"1724",height:"964"})),(0,s.kt)("h3",{id:"determine-osmosis-node-type-requirement"},"Determine Osmosis node type requirement"),(0,s.kt)("p",null,"First, determine how far in the past the desired block height is from the current time. If the desired block height is within the last seven days, you can make the state export with a default snapshot node. Anything further in the past more than likely needs to be done by setting up a node with an archive snapshot as the data for the block in question may not be present due to pruning."),(0,s.kt)("p",null,"In our example, block height 2138101 is many months in the past, so we must use an archive snapshot."),(0,s.kt)("h3",{id:"run-an-osmosis-node"},"Run an Osmosis node"),(0,s.kt)("p",null,"To set up either a default or archive node, either use the Osmosis bash installer ",(0,s.kt)("a",{parentName:"p",href:"https://get.osmosis.zone/"},"located here")," OR follow the instructions step by step ",(0,s.kt)("a",{parentName:"p",href:"../../osmosis-core/osmosisd"},"starting here"),". Ensure you follow the instructions for mainnet and set up using either the archive or default snapshot as determined above. Do not use state sync for this situation."),(0,s.kt)("h3",{id:"install-the-daemon-version-corresponding-to-snapshot-height"},"Install the daemon version corresponding to snapshot height"),(0,s.kt)("p",null,"If you are looking to take a snapshot for a block height that occurred during a previously breaking major release (i.e v3.x, v4.x, v5.x, etc.), you must ensure your daemon is running that version before taking the state export. To see the block height for all major releases, go to ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/osmosis-labs/osmosis/releases"},"Osmosis Releases"),"and check the titles of all major releases. You will see the block height the upgrade took place in the title. In our example, we are taking a state export at block height 2138101. Since v4 released at block height 1314500 and v5 didn't release until block height 2383300, we must ensure the daemon is now running v4 before we take the state export. To change the daemon version (in this example to v4.0.0):"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sh"},"cd $HOME/osmosis\ngit checkout v4.0.0\nmake install\n")),(0,s.kt)("p",null,"Then check the version"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd version\n")),(0,s.kt)("p",null,"Which in this example should output 4.0.0"),(0,s.kt)("p",null,"To reiterate, if your snapshot is being taken on a more recent height where the daemon version is still current, this step will not be required and you can continue with the current daemon version."),(0,s.kt)("h3",{id:"take-the-state-export-snapshot"},"Take the state export (snapshot)"),(0,s.kt)("p",null,"Ensure the daemon is not running in the background. Then, to take a state export at a specified height (in this example 2138101):"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd export 2138101 > state_export.json\n")),(0,s.kt)("p",null,"This process may take 30 minutes or more."),(0,s.kt)("p",null,"NOTE: Some cosmos sdk versions write to STDERR instead of STDOUT. If the above command does not work for you, try to replace the > with 2>\nAs of this writing, v5 and later will require 2> while anything before v5 will just use >"),(0,s.kt)("h3",{id:"export-accounts-in-json-format"},"Export accounts in JSON format"),(0,s.kt)("p",null,"Now that you have a state export file with the name ",(0,s.kt)("inlineCode",{parentName:"p"},"state_export.json"),", the last step needed is to export the accounts and respective balances from the state export. To get all existing Osmosis accounts on the height the state export was taken and write it to a file called ",(0,s.kt)("inlineCode",{parentName:"p"},"balances.json"),":"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd export-derive-balances state_export.json balances.json\n")),(0,s.kt)("p",null,"If you want the export to display specific pool IDs each address address is taking part in (in this example pools 1, 3, 4, and 560):"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sh"},"osmosisd export-derive-balances state_export.json balances.json --breakdown-by-pool-ids 1,3,4,560\n")),(0,s.kt)("p",null,"You will now have a snapshot in json format of all addresses and their respective holdings you can use to assist you in your airdrop distribution!"))}c.isMDXComponent=!0},2049:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/mintscan_height-b5c300287ed37ec4e02c74a276a92aff.png"},95429:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/osmosis_pools-c20178f3785989d5802d0c87db1b470b.png"}}]);