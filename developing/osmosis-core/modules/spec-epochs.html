<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Epochs | Osmosis Docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" type="text/css" href="https://cloud.typography.com/7420256/6416592/css/fonts.css">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:400,500,700&amp;display=swap">
    <link rel="icon" type="image/png" href="/img/favicondocs.png">
    <script>window.onload = function() {
        requestAnimationFrame(function() {
          if (location.hash) {
            const element = document.getElementById(location.hash.slice(1))

            if (element) {
              element.scrollIntoView()
            }
          }
        })
      }</script>
    <meta name="description" content="Osmosis - The Cosmos Interchain AMM">
    <meta property="og:image" content="/img/osmosis-tile.png">
    
    <link rel="preload" href="/assets/css/0.styles.84e08b3a.css" as="style"><link rel="preload" href="/assets/js/app.80473268.js" as="script"><link rel="preload" href="/assets/js/3.dc07ba1b.js" as="script"><link rel="preload" href="/assets/js/51.b4a3dc58.js" as="script"><link rel="prefetch" href="/assets/js/10.24c9e6a0.js"><link rel="prefetch" href="/assets/js/11.9628ca2f.js"><link rel="prefetch" href="/assets/js/12.96cef48e.js"><link rel="prefetch" href="/assets/js/13.bbd5bc1f.js"><link rel="prefetch" href="/assets/js/14.48630607.js"><link rel="prefetch" href="/assets/js/15.9851101d.js"><link rel="prefetch" href="/assets/js/16.0a828fd3.js"><link rel="prefetch" href="/assets/js/17.c8435a6d.js"><link rel="prefetch" href="/assets/js/18.bfdf5456.js"><link rel="prefetch" href="/assets/js/19.d4ff3cad.js"><link rel="prefetch" href="/assets/js/20.7b929709.js"><link rel="prefetch" href="/assets/js/21.038bae74.js"><link rel="prefetch" href="/assets/js/22.a8ee6a06.js"><link rel="prefetch" href="/assets/js/23.8b341ab2.js"><link rel="prefetch" href="/assets/js/24.eea4c5a3.js"><link rel="prefetch" href="/assets/js/25.e0ae9c2a.js"><link rel="prefetch" href="/assets/js/26.e4cc46dc.js"><link rel="prefetch" href="/assets/js/27.4505c43f.js"><link rel="prefetch" href="/assets/js/28.cd5c0810.js"><link rel="prefetch" href="/assets/js/29.e78a697a.js"><link rel="prefetch" href="/assets/js/30.7ff295ac.js"><link rel="prefetch" href="/assets/js/31.89cd90c1.js"><link rel="prefetch" href="/assets/js/32.500bdc4c.js"><link rel="prefetch" href="/assets/js/33.b34f3dea.js"><link rel="prefetch" href="/assets/js/34.c7dfd829.js"><link rel="prefetch" href="/assets/js/35.a2395f58.js"><link rel="prefetch" href="/assets/js/36.f1ea6732.js"><link rel="prefetch" href="/assets/js/37.de1b11b0.js"><link rel="prefetch" href="/assets/js/38.442c5dd8.js"><link rel="prefetch" href="/assets/js/39.4cb2710c.js"><link rel="prefetch" href="/assets/js/4.43314de7.js"><link rel="prefetch" href="/assets/js/40.a7a43808.js"><link rel="prefetch" href="/assets/js/41.14512c7d.js"><link rel="prefetch" href="/assets/js/42.a8b6d3d2.js"><link rel="prefetch" href="/assets/js/43.1c5d5c6b.js"><link rel="prefetch" href="/assets/js/44.c90dd9c8.js"><link rel="prefetch" href="/assets/js/45.a275d9eb.js"><link rel="prefetch" href="/assets/js/46.0ef976ec.js"><link rel="prefetch" href="/assets/js/47.fb9cf477.js"><link rel="prefetch" href="/assets/js/48.3ab410e8.js"><link rel="prefetch" href="/assets/js/49.b848e6bf.js"><link rel="prefetch" href="/assets/js/5.0a074966.js"><link rel="prefetch" href="/assets/js/50.a6d03d74.js"><link rel="prefetch" href="/assets/js/52.96476b72.js"><link rel="prefetch" href="/assets/js/53.dcd8370a.js"><link rel="prefetch" href="/assets/js/54.901b5116.js"><link rel="prefetch" href="/assets/js/55.3e7ae4c7.js"><link rel="prefetch" href="/assets/js/56.19c251d9.js"><link rel="prefetch" href="/assets/js/57.9bda45de.js"><link rel="prefetch" href="/assets/js/58.a46d82ac.js"><link rel="prefetch" href="/assets/js/59.fa04999c.js"><link rel="prefetch" href="/assets/js/6.48ccced6.js"><link rel="prefetch" href="/assets/js/60.bd6470f8.js"><link rel="prefetch" href="/assets/js/61.2f0eddef.js"><link rel="prefetch" href="/assets/js/62.0e35a77f.js"><link rel="prefetch" href="/assets/js/63.8b686430.js"><link rel="prefetch" href="/assets/js/64.8d6d72e2.js"><link rel="prefetch" href="/assets/js/65.3811f636.js"><link rel="prefetch" href="/assets/js/66.9aba4c09.js"><link rel="prefetch" href="/assets/js/67.16984673.js"><link rel="prefetch" href="/assets/js/68.450488af.js"><link rel="prefetch" href="/assets/js/69.229dbb4d.js"><link rel="prefetch" href="/assets/js/7.d8ebe711.js"><link rel="prefetch" href="/assets/js/70.8fb375c6.js"><link rel="prefetch" href="/assets/js/71.8b9b2fa8.js"><link rel="prefetch" href="/assets/js/72.0c703d48.js"><link rel="prefetch" href="/assets/js/73.86a339ef.js"><link rel="prefetch" href="/assets/js/74.be87da9c.js"><link rel="prefetch" href="/assets/js/75.4b775e56.js"><link rel="prefetch" href="/assets/js/76.3a5c53e6.js"><link rel="prefetch" href="/assets/js/77.c8d35ce8.js"><link rel="prefetch" href="/assets/js/78.49d75390.js"><link rel="prefetch" href="/assets/js/79.878b9a3d.js"><link rel="prefetch" href="/assets/js/8.77b1a7e0.js"><link rel="prefetch" href="/assets/js/80.0f33d18f.js"><link rel="prefetch" href="/assets/js/81.9946be76.js"><link rel="prefetch" href="/assets/js/82.6f202521.js"><link rel="prefetch" href="/assets/js/83.9a168e5a.js"><link rel="prefetch" href="/assets/js/84.1baec822.js"><link rel="prefetch" href="/assets/js/85.09354951.js"><link rel="prefetch" href="/assets/js/86.d4ae5209.js"><link rel="prefetch" href="/assets/js/87.86840c17.js"><link rel="prefetch" href="/assets/js/88.c222e8aa.js"><link rel="prefetch" href="/assets/js/89.15d34746.js"><link rel="prefetch" href="/assets/js/9.388dd0a8.js"><link rel="prefetch" href="/assets/js/90.533a9d1d.js"><link rel="prefetch" href="/assets/js/91.b6338bde.js"><link rel="prefetch" href="/assets/js/92.4dc84149.js"><link rel="prefetch" href="/assets/js/93.8a44ffdf.js"><link rel="prefetch" href="/assets/js/94.850de79a.js"><link rel="prefetch" href="/assets/js/95.0d5e0b95.js"><link rel="prefetch" href="/assets/js/96.03d923e9.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.66930185.js">
    <link rel="stylesheet" href="/assets/css/0.styles.84e08b3a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"></div> <a href="/" class="home-link router-link-active"><img src="/img/osmosis-logo-dark.svg" alt="Osmosis Docs" class="logo"> <span class="site-name can-hide">Osmosis Docs</span></a> <a href="/" class="home-link router-link-active"><img src="/img/osmosis-logo-light.svg" alt="Osmosis Docs" class="logoDark"> <span class="site-name can-hide">Osmosis Docs</span></a> <div class="links"><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/developing/" class="nav-link router-link-active">Develop</a></div><div class="nav-item"><a href="/infra/" class="nav-link">Infra</a></div><div class="nav-item"><a href="/validators/" class="nav-link">Validate</a></div><div class="nav-item"><a href="/integrate/" class="nav-link">Integrate</a></div><div class="nav-item"><a href="https://github.com/osmosis-labs/docs" target="_blank" rel="noopener noreferrer" class="nav-link external"><div class="nav-icon"><img src="/img/github.svg"></div></a></div></nav> <form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form></div></header> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/developing/" class="nav-link router-link-active">Develop</a></div><div class="nav-item"><a href="/infra/" class="nav-link">Infra</a></div><div class="nav-item"><a href="/validators/" class="nav-link">Validate</a></div><div class="nav-item"><a href="/integrate/" class="nav-link">Integrate</a></div><div class="nav-item"><a href="https://github.com/osmosis-labs/docs" target="_blank" rel="noopener noreferrer" class="nav-link external"><div class="nav-icon"><img src="/img/github.svg"></div></a></div></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Building dApps</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Tools</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Osmosis Core</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/developing/osmosis-core/" aria-current="page" class="sidebar-link">Chain Development</a></li><li><a href="/developing/osmosis-core/build.html" class="sidebar-link">Build and Test</a></li><li><a href="/developing/osmosis-core/ide-guide.html" class="sidebar-link">Osmosis IDE Setup</a></li><li><a href="/developing/osmosis-core/performance.html" class="sidebar-link">Performance &amp; Profiling</a></li><li><a href="/developing/osmosis-core/contributing.html" class="sidebar-link">Contributing</a></li><li><a href="/developing/osmosis-core/modules/" aria-current="page" class="sidebar-link">Modules</a></li><li><a href="/developing/osmosis-core/modules/spec-epochs.html" aria-current="page" class="active sidebar-link">Epochs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#abstract" class="sidebar-link">Abstract</a></li><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#contents" class="sidebar-link">Contents</a></li><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#concepts" class="sidebar-link">Concepts</a></li><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#state" class="sidebar-link">State</a></li><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#events" class="sidebar-link">Events</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#beginblocker" class="sidebar-link">BeginBlocker</a></li><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#endblocker" class="sidebar-link">EndBlocker</a></li></ul></li><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#keepers" class="sidebar-link">Keepers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#keeper-functions" class="sidebar-link">Keeper functions</a></li></ul></li><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#hooks" class="sidebar-link">Hooks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#how-modules-receive-hooks" class="sidebar-link">How modules receive hooks</a></li><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#panic-isolation" class="sidebar-link">Panic isolation</a></li></ul></li><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#queries" class="sidebar-link">Queries</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#epoch-infos" class="sidebar-link">Epoch Infos</a></li><li class="sidebar-sub-header"><a href="/developing/osmosis-core/modules/spec-epochs.html#current-epoch" class="sidebar-link">Current Epoch</a></li></ul></li></ul></li><li><a href="/developing/osmosis-core/modules/spec-gamm.html" class="sidebar-link">GAMM</a></li><li><a href="/developing/osmosis-core/modules/spec-gov.html" class="sidebar-link">Gov</a></li><li><a href="/developing/osmosis-core/modules/spec-lockup.html" class="sidebar-link">Lockup</a></li><li><a href="/developing/osmosis-core/modules/spec-mint.html" class="sidebar-link">/developing/osmosis-core/modules/spec-mint.html</a></li><li><a href="/developing/osmosis-core/modules/spec-incentives.html" class="sidebar-link">Incentives</a></li><li><a href="/developing/osmosis-core/modules/spec-pool-incentives.html" class="sidebar-link">Pool Incentives</a></li><li><a href="/developing/osmosis-core/modules/spec-superfluid.html" class="sidebar-link">Superfluid Staking</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Networks</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Relaying</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Asset Info</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Key Management</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Osmosis Frontend</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Guides</span> <span class="arrow right"></span></p> <!----></section></li></ul>  <div class="sidebar_footer"></div></aside> <main class="page"> <nav id="breadcrumb" class="breadcrumb-container" data-v-684968f4><a href="/" class="breadcrumb router-link-active" data-v-684968f4><span data-v-684968f4>Home</span></a><a href="/developing/" class="breadcrumb router-link-active" data-v-684968f4><span data-v-684968f4>Developing in Osmosis</span></a><a href="/developing/osmosis-core/" class="breadcrumb router-link-active" data-v-684968f4><span data-v-684968f4>Chain Development</span></a><a href="/developing/osmosis-core/modules/" class="breadcrumb router-link-active" data-v-684968f4><span data-v-684968f4>Modules</span></a><a href="/developing/osmosis-core/modules/spec-epochs.html" aria-current="page" class="breadcrumb router-link-exact-active router-link-active" data-v-684968f4><span data-v-684968f4>Epochs</span></a></nav> <div class="theme-default-content content__default"><h1 id="epochs"><a href="#epochs" class="header-anchor">#</a> Epochs</h1> <h2 id="abstract"><a href="#abstract" class="header-anchor">#</a> Abstract</h2> <p>Often in the SDK, we would like to run certain code every-so often. The
purpose of <code>epochs</code> module is to allow other modules to set that they
would like to be signaled once every period. So another module can
specify it wants to execute code once a week, starting at UTC-time = x.
<code>epochs</code> creates a generalized epoch interface to other modules so that
they can easily be signalled upon such events.</p> <h2 id="contents"><a href="#contents" class="header-anchor">#</a> Contents</h2> <ol><li><strong><a href="#concepts">Concept</a></strong></li> <li><strong><a href="#state">State</a></strong></li> <li><strong><a href="#events">Events</a></strong></li> <li><strong><a href="#keeper">Keeper</a></strong></li> <li><strong><a href="#hooks">Hooks</a></strong></li> <li><strong><a href="#queries">Queries</a></strong></li> <li><strong><a href="#downtime-recovery">Downtime Recovery</a></strong></li></ol> <h2 id="concepts"><a href="#concepts" class="header-anchor">#</a> Concepts</h2> <p>The epochs module defines on-chain timers, that execute at fixed time intervals.
Other SDK modules can then register logic to be executed at the timer ticks.
We refer to the period in between two timer ticks as an &quot;epoch&quot;.</p> <p>Every timer has a unique identifier.
Every epoch will have a start time, and an end time, where <code>end time = start time + timer interval</code>.
On Osmosis mainnet, we only utilize one identifier, with a time interval of <code>one day</code>.</p> <p>The timer will tick at the first block whose blocktime is greater than the timer end time,
and set the start as the prior timer end time. (Notably, its not set to the block time!)
This means that if the chain has been down for awhile, you will get one timer tick per block,
until the timer has caught up.</p> <h2 id="state"><a href="#state" class="header-anchor">#</a> State</h2> <p>The Epochs module keeps a single <a href="https://github.com/osmosis-labs/osmosis/blob/b4befe4f3eb97ebb477323234b910c4afafab9b7/proto/osmosis/epochs/genesis.proto#L12" target="_blank" rel="noopener noreferrer"><code>EpochInfo</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> per identifier.
This contains the current state of the timer with the corresponding identifier.
Its fields are modified at every timer tick.
EpochInfos are initialized as part of genesis initialization or upgrade logic,
and are only modified on begin blockers.</p> <h2 id="events"><a href="#events" class="header-anchor">#</a> Events</h2> <p>The <code>epochs</code> module emits the following events:</p> <h3 id="beginblocker"><a href="#beginblocker" class="header-anchor">#</a> BeginBlocker</h3> <table><thead><tr><th>Type</th> <th>Attribute Key</th> <th>Attribute Value</th></tr></thead> <tbody><tr><td>epoch_start</td> <td>epoch_number</td> <td>{epoch_number}</td></tr> <tr><td>epoch_start</td> <td>start_time</td> <td>{start_time}</td></tr></tbody></table> <h3 id="endblocker"><a href="#endblocker" class="header-anchor">#</a> EndBlocker</h3> <table><thead><tr><th>Type</th> <th>Attribute Key</th> <th>Attribute Value</th></tr></thead> <tbody><tr><td>epoch_end</td> <td>epoch_number</td> <td>{epoch_number}</td></tr></tbody></table> <h2 id="keepers"><a href="#keepers" class="header-anchor">#</a> Keepers</h2> <h3 id="keeper-functions"><a href="#keeper-functions" class="header-anchor">#</a> Keeper functions</h3> <p>Epochs keeper module provides utility functions to manage epochs.</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// Keeper is the interface for lockup module keeper</span>
<span class="token keyword">type</span> Keeper <span class="token keyword">interface</span> <span class="token punctuation">{</span>
  <span class="token comment">// GetEpochInfo returns epoch info by identifier</span>
  <span class="token function">GetEpochInfo</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> identifier <span class="token builtin">string</span><span class="token punctuation">)</span> types<span class="token punctuation">.</span>EpochInfo
  <span class="token comment">// SetEpochInfo set epoch info</span>
  <span class="token function">SetEpochInfo</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> epoch types<span class="token punctuation">.</span>EpochInfo<span class="token punctuation">)</span> 
  <span class="token comment">// DeleteEpochInfo delete epoch info</span>
  <span class="token function">DeleteEpochInfo</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> identifier <span class="token builtin">string</span><span class="token punctuation">)</span>
  <span class="token comment">// IterateEpochInfo iterate through epochs</span>
  <span class="token function">IterateEpochInfo</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> fn <span class="token keyword">func</span><span class="token punctuation">(</span>index <span class="token builtin">int64</span><span class="token punctuation">,</span> epochInfo types<span class="token punctuation">.</span>EpochInfo<span class="token punctuation">)</span> <span class="token punctuation">(</span>stop <span class="token builtin">bool</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// Get all epoch infos</span>
  <span class="token function">AllEpochInfos</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>EpochInfo
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="hooks"><a href="#hooks" class="header-anchor">#</a> Hooks</h2> <div class="language-go line-numbers-mode"><pre class="language-go"><code>  <span class="token comment">// the first block whose timestamp is after the duration is counted as the end of the epoch</span>
  <span class="token function">AfterEpochEnd</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> epochIdentifier <span class="token builtin">string</span><span class="token punctuation">,</span> epochNumber <span class="token builtin">int64</span><span class="token punctuation">)</span>
  <span class="token comment">// new epoch is next block of epoch end block</span>
  <span class="token function">BeforeEpochStart</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> epochIdentifier <span class="token builtin">string</span><span class="token punctuation">,</span> epochNumber <span class="token builtin">int64</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="how-modules-receive-hooks"><a href="#how-modules-receive-hooks" class="header-anchor">#</a> How modules receive hooks</h3> <p>On hook receiver function of other modules, they need to filter
<code>epochIdentifier</code> and only do executions for only specific
epochIdentifier. Filtering epochIdentifier could be in <code>Params</code> of other
modules so that they can be modified by governance.</p> <p>This is the standard dev UX of this:</p> <div class="language-golang line-numbers-mode"><pre class="language-text"><code>func (k MyModuleKeeper) AfterEpochEnd(ctx sdk.Context, epochIdentifier string, epochNumber int64) {
    params := k.GetParams(ctx)
    if epochIdentifier == params.DistrEpochIdentifier {
    // my logic
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="panic-isolation"><a href="#panic-isolation" class="header-anchor">#</a> Panic isolation</h3> <p>If a given epoch hook panics, its state update is reverted, but we keep
proceeding through the remaining hooks. This allows more advanced epoch
logic to be used, without concern over state machine halting, or halting
subsequent modules.</p> <p>This does mean that if there is behavior you expect from a prior epoch
hook, and that epoch hook reverted, your hook may also have an issue. So
do keep in mind &quot;what if a prior hook didn't get executed&quot; in the safety
checks you consider for a new epoch hook.</p> <h2 id="queries"><a href="#queries" class="header-anchor">#</a> Queries</h2> <p>Epochs module is providing below queries to check the module's state.</p> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code><span class="token keyword">service</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>
  <span class="token comment">// EpochInfos provide running epochInfos</span>
  <span class="token keyword">rpc</span> <span class="token function">EpochInfos</span><span class="token punctuation">(</span><span class="token class-name">QueryEpochsInfoRequest</span><span class="token punctuation">)</span> <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token class-name">QueryEpochsInfoResponse</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// CurrentEpoch provide current epoch of specified identifier</span>
  <span class="token keyword">rpc</span> <span class="token function">CurrentEpoch</span><span class="token punctuation">(</span><span class="token class-name">QueryCurrentEpochRequest</span><span class="token punctuation">)</span> <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token class-name">QueryCurrentEpochResponse</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="epoch-infos"><a href="#epoch-infos" class="header-anchor">#</a> Epoch Infos</h3> <p>Query the currently running epochInfos</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>osmosisd query epochs epoch-infos
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><details class="custom-block details"><summary>Example</summary> <p>An example output:</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>epochs:
- current_epoch: <span class="token string">&quot;183&quot;</span>
  current_epoch_start_height: <span class="token string">&quot;2438409&quot;</span>
  current_epoch_start_time: <span class="token string">&quot;2021-12-18T17:16:09.898160996Z&quot;</span>
  duration: 86400s
  epoch_counting_started: <span class="token boolean">true</span>
  identifier: day
  start_time: <span class="token string">&quot;2021-06-18T17:00:00Z&quot;</span>
- current_epoch: <span class="token string">&quot;26&quot;</span>
  current_epoch_start_height: <span class="token string">&quot;2424854&quot;</span>
  current_epoch_start_time: <span class="token string">&quot;2021-12-17T17:02:07.229632445Z&quot;</span>
  duration: 604800s
  epoch_counting_started: <span class="token boolean">true</span>
  identifier: week
  start_time: <span class="token string">&quot;2021-06-18T17:00:00Z&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></details> <h3 id="current-epoch"><a href="#current-epoch" class="header-anchor">#</a> Current Epoch</h3> <p>Query the current epoch by the specified identifier</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>osmosisd query epochs current-epoch <span class="token punctuation">[</span>identifier<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><details class="custom-block details"><summary>Example</summary> <p>Query the current <code>day</code> epoch:</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>osmosisd query epochs current-epoch day
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Which in this example outputs:</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>current_epoch: <span class="token string">&quot;183&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></details></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/osmosis-labs/docs/edit/main/developing/osmosis-core/modules/spec-epochs.md" target="_blank" rel="noopener noreferrer"><img src="/img/github.svg" style="max-width:25px;vertical-align:middle;"> 
    Edit this page on GitHub</a></div> <div class="last-updated"><span class="prefix">Updated on:</span> <span class="time">7/1/2022, 11:00:36 PM</span></div></footer> <div class="page-nav"><div class="inner"><div class="prev"><a href="/developing/osmosis-core/modules/" class="router-link-active">Modules</a></div> <div class="next"><a href="/developing/osmosis-core/modules/spec-gamm.html">GAMM</a></div></div></div>  <div class="footer-container"><div class="company"><div class="copyright">Osmosis Labs</div></div> <div class="links-container"><ul class="learn"><li>Learn</li> <li><a href="https://medium.com/@Osmosis" target="_blank">Medium</a></li> <li><a href="https://commonwealth.im/osmosis/" target="_blank">Commonwealth</a></li></ul> <ul class="developers"><li>Tools</li> <li><a href="https://app.osmosis.zone" target="_blank">Osmosis App</a></li> <li><a href="https://www.mintscan.io/osmosis" target="_blank">Osmosis Explorer</a></li> <li><a href="https://info.osmosis.zone/" target="_blank">Stats</a></li></ul> <ul class="developers"><li>Osmo</li> <li><a href="https://docs.osmosis.zone/overview/osmo.html#purpose" target="_blank">What is Osmo?</a></li> <li><a href="https://docs.osmosis.zone/overview/osmosis-app/#bonding-lp-tokens" target="_blank">Pools</a></li> <li><a href="https://docs.osmosis.zone/overview/wallets/keplr/" target="_blank">Wallets</a></li></ul> <ul class="developers"><li>Foundation</li> <li><a href="https://angel.co/company/osmosis-labs/jobs" target="_blank">Careers</a></li></ul> <ul class="developers"><li>Developers</li> <li><a href="https://github.com/osmosis-labs" target="_blank">Github</a></li></ul> <ul class="developers"><li>Validators</li> <li><a href="https://docs.osmosis.zone/validators/" target="_blank">Validator Guide</a></li> <li><a href="https://discord.gg/3gSAbqV3Qp" target="_blank">Discord Channel</a></li></ul></div> <div class="sns-container"><div class="logos"><a href="https://discord.gg/3gSAbqV3Qp" rel="noopener" target="_blank"><img src="/img/discord.svg" alt="link to Osmosis discord room"></a> <a href="https://medium.com/@Osmosis" rel="noopener" target="_blank"><img src="/img/medium.svg" alt="link to Osmosis medium"></a> <a href="https://twitter.com/osmosiszone" rel="noopener" target="_blank"><img src="/img/twitter.svg" alt="link to Osmosis twitter"></a> <a href="https://www.youtube.com/channel/UC3ScmmLC4WUJAkINyf_p2Rw" rel="noopener" target="_blank"><img src="/img/icon_youtube.png" alt="link to Osmosis youtube"></a> <a href rel="noopener" target="_blank"><img src="/img/icon_telegram.png" alt="link to Osmosis telegram room"></a></div> <a href="https://www.osmosis.zone" target="_blank" class="osmosiszone">osmosis.zone</a></div></div></main></div><div class="global-ui"><div class="darkmode-switch"><div class="item day active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon"><path d="M512 256a42.666667 42.666667 0 0 0 42.666667-42.666667V128a42.666667 42.666667 0 0 0-85.333334 0v85.333333a42.666667 42.666667 0 0 0 42.666667 42.666667zM896 469.333333h-85.333333a42.666667 42.666667 0 0 0 0 85.333334h85.333333a42.666667 42.666667 0 0 0 0-85.333334zM256 512a42.666667 42.666667 0 0 0-42.666667-42.666667H128a42.666667 42.666667 0 0 0 0 85.333334h85.333333a42.666667 42.666667 0 0 0 42.666667-42.666667zM265.386667 213.333333a42.666667 42.666667 0 0 0-59.306667 62.72l61.44 59.306667a42.666667 42.666667 0 0 0 31.146667 11.946667 42.666667 42.666667 0 0 0 30.72-13.226667 42.666667 42.666667 0 0 0 0-60.16zM725.333333 347.306667a42.666667 42.666667 0 0 0 29.44-11.946667l61.44-59.306667A42.666667 42.666667 0 0 0 758.613333 213.333333l-61.44 60.586667a42.666667 42.666667 0 0 0 0 60.16 42.666667 42.666667 0 0 0 28.16 13.226667zM512 768a42.666667 42.666667 0 0 0-42.666667 42.666667v85.333333a42.666667 42.666667 0 0 0 85.333334 0v-85.333333a42.666667 42.666667 0 0 0-42.666667-42.666667zM756.48 688.64a42.666667 42.666667 0 0 0-59.306667 61.44L758.613333 810.666667a42.666667 42.666667 0 0 0 29.44 11.946666 42.666667 42.666667 0 0 0 30.72-12.8 42.666667 42.666667 0 0 0 0-60.586666zM267.52 688.64l-61.44 59.306667a42.666667 42.666667 0 0 0 0 60.586666 42.666667 42.666667 0 0 0 30.72 12.8 42.666667 42.666667 0 0 0 28.586667-10.666666l61.44-59.306667a42.666667 42.666667 0 0 0-59.306667-61.44zM512 341.333333a170.666667 170.666667 0 1 0 170.666667 170.666667 170.666667 170.666667 0 0 0-170.666667-170.666667z"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon"><path d="M935.538601 630.40178c-11.43005-11.432249-28.673759-14.738607-43.531086-8.353536-46.733115 20.10317-96.362866 30.296859-147.50719 30.296859-99.589478 0-193.221796-38.783705-263.640252-109.20316-108.636744-108.636744-139.609745-270.022125-78.9083-411.148441 6.388069-14.85233 3.078713-32.098837-8.353536-43.532285-11.432249-11.432249-28.675758-14.743604-43.532285-8.354536-52.637312 22.64025-100.017388 54.809439-140.82552 95.616372-85.346135 85.346135-132.346869 198.821199-132.346869 319.519766 0 120.699566 47.001733 234.172631 132.347868 319.518766s198.821199 132.349067 319.517567 132.349067c120.699566 0 234.172431-47.002932 319.520765-132.351066 40.808132-40.810131 72.977122-88.190207 95.615373-140.82552C950.282205 659.081735 946.971849 641.834029 935.538601 630.40178z" p-id="3638"></path></svg></div></div></div></div>
    <script src="/assets/js/app.80473268.js" defer></script><script src="/assets/js/3.dc07ba1b.js" defer></script><script src="/assets/js/51.b4a3dc58.js" defer></script>
  </body>
</html>
